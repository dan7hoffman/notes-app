<div class="notes-container">
  <h2>My Notes</h2>
  <p>Total Notes: {{ noteCount() }}</p>
  <p>Active Notes: {{ activeNoteCount() }}</p>
  <p>Deleted Notes: {{ deletedNoteCount() }}</p>

  <form (ngSubmit)="addOrUpdate()" #noteForm="ngForm">
    <input
      type="text"
      placeholder="Enter Note Title"
      [(ngModel)]="newTitle"
      name="title"
      required
    />
    <textarea
      placeholder="Enter note content..."
      [(ngModel)]="newContent"
      name="content"
    ></textarea>

    <button type="submit" [disabled]="!noteForm.valid">
      {{ editingNote ? 'Update Note' : 'Add Note' }}
    </button>
    <button type="button" *ngIf="editingNote" (click)="cancelEdit()">Cancel</button>
  </form>

  <div class="filter">
    <button (click)="setFilter('ALL')" [class.active]="currentFilter === 'ALL'">All ({{ noteCount() }})</button>
    <button (click)="setFilter('ACTIVE')" [class.active]="currentFilter === 'ACTIVE'">Active ({{ activeNoteCount() }})</button>
  </div>

<input
  type="text"
  placeholder="Search..."
  [ngModel]="searchTerm()"
  (ngModelChange)="searchTerm.set($event)"
>

  <div *ngIf="filteredNotes().length === 0">
    <p>No notes to display.</p>
  </div>

  <div class="note" *ngFor="let note of filteredNotes()">
    <h3>{{ note.title }}</h3>
    <p>{{ note.content }}</p>
    <small>Created at: {{ formatDate(note.createdAt) }}</small>
    <br />
    <small *ngIf="note.lastModifiedAt">Last modified at: {{ formatDateTime(note.lastModifiedAt) }}</small>
    <br />
    <small *ngIf="note.deletionAt">Deleted at: {{ formatDateTime(note.deletionAt) }}</small>
    <br />
    <small *ngIf="note.deleted">Deleted: {{ note.deleted ? 'Yes' : 'No' }}</small>
    <div class="actions">
      <button (click)="edit(note)">Edit</button>
      <button (click)="softDelete(note.id)">Soft Delete</button>
      <button (click)="hardDelete(note.id)">Hard Delete</button>
    </div>
  </div>
</div>
