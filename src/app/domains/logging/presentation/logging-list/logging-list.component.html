<div class="logging-container">
  <div class="header-row">
    <h2>System Logs</h2>
    <p>This logs actions across other Domains</p>

    <div class="header-actions">
      <button
        class="clear-btn"
        (click)="clearAllLogs()"
        [disabled]="filteredLogs().length === 0"
        title="Clear all logs">
        <span class="material-icons">delete_sweep</span>
        Clear All
      </button>
    </div>
  </div>

  <!-- Search + Level Filter -->
  <div class="search-controls">
    <input
      #searchInputElement
      type="text"
      placeholder="Search logs..."
      (input)="onSearchChange(searchInputElement.value)"
    />

    <select
      #levelSelect
      [value]="selectedLevel()"
      (change)="onLevelChange(levelSelect.value)"
    >
      <option value="all">All Levels</option>
      <option value="info">Info</option>
      <option value="warn">Warning</option>
      <option value="error">Error</option>
    </select>
  </div>

  <!-- No logs message -->
  @if (filteredLogs().length === 0) {
    <p class="no-logs">No logs available</p>
  } @else {
    <!-- Logs list -->
    <div class="logs-list">
      @for (log of paginatedLogs(); track log.id) {
        <div class="log-entry" [class]="'log-' + log.level">
          <div class="log-header">
            <span class="log-level">
              <span class="log-icon material-icons">
                {{ logLevelIcons[log.level] }}
              </span>
              {{ log.level.toUpperCase() }}
            </span>
            <span class="log-timestamp">{{ formatAbsoluteDateTime(log.timeStamp) }}</span>
          </div>

          <div class="log-message">{{ log.message }}</div>

          @if (log.context) {
            <div class="log-context">Context: {{ log.context }}</div>
          }

          <div class="log-actions">
            @if (log.data) {
              <button class="expand-btn" (click)="toggleExpand(log.id)">
                <span class="material-icons">
                  {{ isExpanded(log.id) ? 'expand_less' : 'expand_more' }}
                </span>
                {{ isExpanded(log.id) ? 'Collapse' : 'Expand' }} Data
              </button>
            }
            <button class="delete-btn" (click)="deleteLog(log.id)" title="Delete log">
              <span class="material-icons">delete</span>
              Delete
            </button>
          </div>

          @if (log.data && isExpanded(log.id)) {
            <div class="log-data">
              <pre>{{ log.data | json }}</pre>
            </div>
          }
        </div>
      }
    </div>

    <!-- Pagination controls -->
    @if (totalPages() > 1) {
      <div class="pagination-controls">
        <button
          class="pagination-btn"
          (click)="previousPage()"
          [disabled]="!canGoPrevious()"
          title="Previous page">
          <span class="material-icons">chevron_left</span>
          Previous
        </button>

        <span class="pagination-info">
          Page {{ currentPage() + 1 }} of {{ totalPages() }}
          ({{ filteredLogs().length }} total logs)
        </span>

        <button
          class="pagination-btn"
          (click)="nextPage()"
          [disabled]="!canGoNext()"
          title="Next page">
          Next
          <span class="material-icons">chevron_right</span>
        </button>
      </div>
    }
  }
</div>
